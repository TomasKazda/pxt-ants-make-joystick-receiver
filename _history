{"entries":[{"timestamp":1764530417904,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":0,"length1":81,"diffs":[[1,""]]},{"start1":1,"length1":3510,"diffs":[[1,""]]}]},{"type":"edited","filename":"pxt.json","patch":[{"start1":250,"length1":45,"diffs":[[1,"    \"languageRestriction\": \"javascript-only\",\n    \"additionalFilePaths\": []\n"]]}]}]},{"timestamp":1764530556900,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":417,"length1":33,"diffs":[[1,"    { key: \"A\", value: false },\n"]]}]}]},{"timestamp":1764533048918,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":417,"length1":42,"diffs":[[1,"    { key:  \"A\", value: false },\n"]]}]}]},{"timestamp":1764533050271,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":417,"length1":32,"diffs":[[1,"    { key: ButtonKey \"A\", value: false },\n"]]}]}]},{"timestamp":1764533054837,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":769,"length1":6,"diffs":[[1,""]]}]}]},{"timestamp":1764533904146,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":769,"length1":5,"diffs":[[1,""]]},{"start1":770,"length1":0,"diffs":[[1,"    \n"]]}]}]},{"timestamp":1764533905899,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":81,"length1":24,"diffs":[[1,""]]},{"start1":723,"length1":531,"diffs":[[1,""]]},{"start1":769,"length1":91,"diffs":[[1,"    \n"]]}]}]},{"timestamp":1764534500875,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"main.ts","patch":[{"start1":882,"length1":233,"diffs":[[1,"        if ((start + 10000) > control.millis()) pairingMode = false;\n        \n"]]},{"start1":1240,"length1":46,"diffs":[[1,""]]}]}]},{"timestamp":1764535235468,"editorVersion":"8.0.18","changes":[{"type":"edited","filename":"pxt.json","patch":[{"start1":218,"length1":44,"diffs":[[1,""]]}]},{"type":"added","filename":"test.ts","value":"// tests go here; this will not be compiled when this package is used as an extension.\n"},{"type":"added","filename":"main.blocks","value":"<xml xmlns=\"http://www.w3.org/1999/xhtml\">\n  <block type=\"pxt-on-start\"></block>\n  <block type=\"device_forever\"></block>\n</xml>"}]}],"snapshots":[{"timestamp":1764530417903,"editorVersion":"8.0.18","text":{"main.ts":"\n","README.md":"","pxt.json":"{\n    \"name\": \"pxt-am044-receiver\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"tsprj\",\n    \"languageRestriction\": \"javascript-only\",\n    \"additionalFilePaths\": []\n}\n"}},{"timestamp":1764533048918,"editorVersion":"8.0.18","text":{"main.ts":"radio.setGroup(1)\nradio.setFrequencyBand(40)\nradio.setTransmitSerialNumber(true)\n\ntype ButtonKey = \"A\" | \"B\" | \"C\" | \"D\" | \"E\" | \"F\" | \"P\"\ndeclare type PinMapItem = {\n    key: ButtonKey\n    pin: DigitalPin\n}\ndeclare type ButtonStateItem = {\n    key: ButtonKey\n    value: boolean\n}\ndeclare type JoyStateItem = {\n    dirArrow: number,\n    strength: number,\n    deg: number\n}\n\nconst btnState: Array<ButtonStateItem> = [\n    { key: \"A\", value: false },\n    { key: \"B\", value: false },\n    { key: \"C\", value: false },\n    { key: \"D\", value: false },\n    { key: \"E\", value: false },\n    { key: \"F\", value: false },\n    { key: \"P\", value: false }\n]\nconst joyState: JoyStateItem = {\n    dirArrow: 0,\n    strength: 0,\n    deg: 0\n}\n\nradio.onReceivedNumber(function (n: number) {\n    let buttonsMask = n & 0b1111111      // bity 0–6\n    let dir = (n >> 7) & 0b111           // bity 7–9\n    let strength = (n >> 10) & 0b1111111 // bity 10–16\n    let deg = (n >> 17) & 0b111111111    // bity 17–25\n\n    for (let i = 0; i < btnState.length; i++) {\n        btnState[i].value = (buttonsMask & (1 << i)) != 0\n    }\n    joyState.dirArrow = dir\n    joyState.strength = strength\n    joyState.deg = deg\n\n    refreshDisplay();\n})\n\n\nfunction getImage(ch: string): Image {\n    let result: Image = images.createImage(`\n        . . . . .\n        . . . . .\n        . # # # .\n        . . . . .\n        . . . . .\n        `)\n\n    switch (ch.charAt(0).toUpperCase()) {\n        case \"A\":\n            result = images.createImage(`\n                . # # # .\n                # . . . #\n                # # # # #\n                # . . . #\n                # . . . #\n                `)\n            break;\n        case \"B\":\n            result = images.createImage(`\n                # # # . .\n                # . . # .\n                # # # . .\n                # . . # .\n                # # # . .\n                `)\n            break;\n        case \"C\":\n            result = images.createImage(`\n                . # # # .\n                # . . . .\n                # . . . .\n                # . . . .\n                . # # # .\n                `)\n            break;\n        case \"D\":\n            result = images.createImage(`\n                # # # . .\n                # . . # .\n                # . . # .\n                # . . # .\n                # # # . .\n                `)\n            break;\n        case \"E\":\n            result = images.createImage(`\n                # # # # #\n                # . . . .\n                # # # # .\n                # . . . .\n                # # # # #\n                `)\n            break;\n        case \"F\":\n            result = images.createImage(`\n                # # # # #\n                # . . . .\n                # # # # .\n                # . . . .\n                # . . . .\n                `)\n            break;\n        case \"P\":\n            result = images.createImage(`\n                # # # # .\n                # . . . #\n                # # # # .\n                # . . . .\n                # . . . .\n                `)\n            break;\n    }\n\n    const arrNo: number = ch.charCodeAt(0) - 48\n    if (arrNo >= 0 && arrNo <= 7) result = images.arrowImage(arrNo);\n\n    return result;\n}\n\nfunction refreshDisplay() {\n    let imageToShow: Image = getImage(\"-\");\n    if (joyState.strength > 3) {\n        imageToShow = getImage(joyState.dirArrow.toString())\n    } else {\n        joyState.dirArrow = 0\n        joyState.deg = 0\n    }\n    for (let btn of btnState) {\n        if (btn.value) {\n            imageToShow = getImage(btn.key)\n            break;\n        }\n    }\n    imageToShow.showImage(0, 0);\n}\n","README.md":"","pxt.json":"{\n    \"name\": \"pxt-am044-receiver\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"tsprj\",\n    \"languageRestriction\": \"javascript-only\"\n}\n"}},{"timestamp":1764534854051,"editorVersion":"8.0.18","text":{"main.ts":"radio.setGroup(1)\nradio.setFrequencyBand(40)\nradio.setTransmitSerialNumber(true)\nlet pairedSerialNo = -1\n\ntype ButtonKey = \"A\" | \"B\" | \"C\" | \"D\" | \"E\" | \"F\" | \"P\"\ndeclare type PinMapItem = {\n    key: ButtonKey\n    pin: DigitalPin\n}\ndeclare type ButtonStateItem = {\n    key: ButtonKey\n    value: boolean\n}\ndeclare type JoyStateItem = {\n    dirArrow: number,\n    strength: number,\n    deg: number\n}\n\nconst btnState: Array<ButtonStateItem> = [\n    { key: \"A\", value: false },\n    { key: \"B\", value: false },\n    { key: \"C\", value: false },\n    { key: \"D\", value: false },\n    { key: \"E\", value: false },\n    { key: \"F\", value: false },\n    { key: \"P\", value: false }\n]\nconst joyState: JoyStateItem = {\n    dirArrow: 0,\n    strength: 0,\n    deg: 0\n}\n\nlet pairingMode = false\nconst doPairing = () => {\n    pairingMode = true\n    const start = control.millis();\n    while (pairingMode) {\n        if ((start + 10000) > control.millis()) pairingMode = false;\n        basic.showIcon(IconNames.Pitchfork, 0)\n        music.playTone(440, 100)\n        basic.clearScreen();\n        basic.pause(300)\n    }\n}\ninput.onLogoEvent(TouchButtonEvent.LongPressed, doPairing)\nradio.onReceivedValue(function(name: string, value: number) {\n    if (name===\"serial\" && pairingMode) {\n        if (radio.receivedPacket(RadioPacketProperty.SerialNumber) === value)\n        pairedSerialNo = value\n        pairingMode = false\n    }\n})\n\nradio.onReceivedNumber(function (n: number) {\n    if (pairedSerialNo !== radio.receivedPacket(RadioPacketProperty.SerialNumber)) return;\n\n    let buttonsMask = n & 0b1111111      // bity 0–6\n    let dir = (n >> 7) & 0b111           // bity 7–9\n    let strength = (n >> 10) & 0b1111111 // bity 10–16\n    let deg = (n >> 17) & 0b111111111    // bity 17–25\n\n    for (let i = 0; i < btnState.length; i++) {\n        btnState[i].value = (buttonsMask & (1 << i)) != 0\n    }\n    joyState.dirArrow = dir\n    joyState.strength = strength\n    joyState.deg = deg\n\n    refreshDisplay();\n})\n\n\nfunction getImage(ch: string): Image {\n    let result: Image = images.createImage(`\n        . . . . .\n        . . . . .\n        . # # # .\n        . . . . .\n        . . . . .\n        `)\n\n    switch (ch.charAt(0).toUpperCase()) {\n        case \"A\":\n            result = images.createImage(`\n                . # # # .\n                # . . . #\n                # # # # #\n                # . . . #\n                # . . . #\n                `)\n            break;\n        case \"B\":\n            result = images.createImage(`\n                # # # . .\n                # . . # .\n                # # # . .\n                # . . # .\n                # # # . .\n                `)\n            break;\n        case \"C\":\n            result = images.createImage(`\n                . # # # .\n                # . . . .\n                # . . . .\n                # . . . .\n                . # # # .\n                `)\n            break;\n        case \"D\":\n            result = images.createImage(`\n                # # # . .\n                # . . # .\n                # . . # .\n                # . . # .\n                # # # . .\n                `)\n            break;\n        case \"E\":\n            result = images.createImage(`\n                # # # # #\n                # . . . .\n                # # # # .\n                # . . . .\n                # # # # #\n                `)\n            break;\n        case \"F\":\n            result = images.createImage(`\n                # # # # #\n                # . . . .\n                # # # # .\n                # . . . .\n                # . . . .\n                `)\n            break;\n        case \"P\":\n            result = images.createImage(`\n                # # # # .\n                # . . . #\n                # # # # .\n                # . . . .\n                # . . . .\n                `)\n            break;\n    }\n\n    const arrNo: number = ch.charCodeAt(0) - 48\n    if (arrNo >= 0 && arrNo <= 7) result = images.arrowImage(arrNo);\n\n    return result;\n}\n\nfunction refreshDisplay() {\n    let imageToShow: Image = getImage(\"-\");\n    if (joyState.strength > 3) {\n        imageToShow = getImage(joyState.dirArrow.toString())\n    } else {\n        joyState.dirArrow = 0\n        joyState.deg = 0\n    }\n    for (let btn of btnState) {\n        if (btn.value) {\n            imageToShow = getImage(btn.key)\n            break;\n        }\n    }\n    imageToShow.showImage(0, 0);\n}\n","README.md":"","pxt.json":"{\n    \"name\": \"pxt-am044-receiver\",\n    \"description\": \"\",\n    \"dependencies\": {\n        \"core\": \"*\",\n        \"radio\": \"*\",\n        \"microphone\": \"*\"\n    },\n    \"files\": [\n        \"main.ts\",\n        \"README.md\"\n    ],\n    \"preferredEditor\": \"tsprj\",\n    \"languageRestriction\": \"javascript-only\"\n}\n"}}],"shares":[],"lastSaveTime":1764535235470}